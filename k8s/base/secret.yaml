# NOTE: ECR credentials should be managed via IAM Roles for Service Accounts (IRSA)
# or External Secrets Operator, not as a static secret.
#
# For IRSA approach (recommended):
# 1. Create IAM role with ECR pull permissions
# 2. Annotate the ServiceAccount with the role ARN:
#    eks.amazonaws.com/role-arn: arn:aws:iam::ACCOUNT_ID:role/ROLE_NAME
# 3. Pods will automatically get ECR credentials
#
# If you must use a static secret (not recommended), uncomment and populate:
# ---
# apiVersion: v1
# kind: Secret
# metadata:
#   name: container-registry
#   namespace: product-catalog
#   labels:
#     app: product-catalog
#     config-type: registry-credentials
# type: kubernetes.io/dockerconfigjson
# stringData:
#   .dockerconfigjson: |
#     {
#       "auths": {
#         "692298411961.dkr.ecr.us-east-1.amazonaws.com": {
#           "username": "AWS",
#           "password": "<ECR_TOKEN>",
#           "auth": "<BASE64_OF_AWS:ECR_TOKEN>"
#         }
#       }
#     }
---
# NOTE: postgres-credentials secret was removed as it was unused
# The application uses product-catalog-secrets below
#
# If you need a separate database credentials secret for other tools,
# you can create it separately
---
apiVersion: v1
kind: Secret
metadata:
  name: product-catalog-secrets
  namespace: product-catalog
  labels:
    app: product-catalog
    config-type: secrets
type: Opaque
stringData:
  # AWS RDS Connection Configuration
  # Password special characters are URL-encoded:
  # Original: kmWh%IMo9jz-NCe_18T$F30Z7L*6qp6Y
  # Encoded: kmWh%25IMo9jz-NCe_18T%24F30Z7L%2A6qp6Y
  # % -> %25, $ -> %24, * -> %2A
  #
  # Connection parameters explained:
  # - sslmode=require: Use SSL/TLS for secure connection to RDS
  # - connectTimeout=30: Wait up to 30 seconds for initial connection
  # - socketTimeout=60: Wait up to 60 seconds for query responses
  # - loginTimeout=30: Wait up to 30 seconds for authentication
  # - tcpKeepAlive=true: Enable TCP keepalive to prevent idle timeouts
  db-url: "jdbc:postgresql://base-infrastructure-dev-app-db.ced8882c83js.us-east-1.rds.amazonaws.com:5432/appdb?sslmode=require&connectTimeout=30&socketTimeout=60&loginTimeout=30&tcpKeepAlive=true&ApplicationName=product-catalog-service"
  db-username: "dbadmin"
  # Password with special characters - these are passed as-is when set via env variable
  # JDBC driver handles them correctly when not in the URL
  db-password: "kmWh%IMo9jz-NCe_18T$F30Z7L*6qp6Y"
  jwt-secret: "your-development-jwt-secret-key-change-in-production-use-strong-random-key"

